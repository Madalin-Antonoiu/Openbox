	<template>
	<div id="sockets">

		<!-- MacOs Terminal-->
		<div id="youtubeTerminal">
			<div id="bar"> 
				<span id="whatfor">Youtube Logs</span>
				
				<div id="red"></div>
				<div id="yellow"></div>
				<div id="green"></div>
			</div>
			<ul class="list-container" v-chat-scroll > 
				<li 
						v-for="event in events" :key="event.id" 
						ref="playingPaused"
						
				> 
					<span class="id">{{event.id}} </span>  <!-- .substring(0, 8)-->
					<span :class="{'play': event.action === 'started watching.', 
												'pause': event.action === 'paused.', 
												'': event.action == 'joined room.', 
												'leftRoom': event.action == 'left room.',
												'endView' : event.action == 'ended watching.',
												
												}"
					> {{event.action}}
					</span>  

			
					<!-- <span ref="fromNow" >{{ event.timestamp  }}</span>   Future reference, or local component-->
					<dynamic-from-now class="timestamp" :interval="60000"></dynamic-from-now>
				</li>
			</ul>
			<button id="clear" >Delete</button> <!-- @click="clearLogs"-->
		</div>
				
			<div class="ytb-but"> 
					<button @click="playVideo">Play</button>
					<button @click="pauseVideo">Pause</button>
					<button @click="seekTo">Seek To</button>
					<button @click="playAll">Play All</button>
			</div>


		<youtube ref="youtube" id="ytb" 
				:video-id="videoId" 
				@ready="ready" 
				@playing="playing" 
				@paused="paused"
				@ended="ended"
		></youtube>

	

		<!-- Spare Mac Terminal
		<div id="bar"> 
			<span id="whatfor">Room Logs</span>
			<div id="red"></div>
			<div id="yellow"></div>
			<div id="green"></div>
		</div>
			<ul class="list-container" style="opacity: 0.6; filter: blur(1px);">
				<li>

				</li>
			</ul>
		-->

	</div>
	</template>

	<script>
	/* eslint-disable */
	import io from 'socket.io-client'; 


	export default {
		name: 'YouSync',
		data(){
			return {
						socket: {},
						context: 0,
						position :{x: 0, y: 0},
						videoId: 'q0hyYWKXF0Q',
						events: [],
						username: "",

			}
		},
		created(){
			this.socket = io("http://localhost:3000/"); // http://192.168.100.3:3000/" Client socket to > server adress / Gitpod change
		},
		mounted(){
				var username = prompt('What\'s your username?');

				if (username){ 

					this.socket.emit('little_newbie', username);

					this.socket.on('disconnect', data => {  
							
						this.events.push(data);

					})
					this.socket.on('playing', data => {  

							this.events.push(data);
						//this.player.playVideo(); // Send command to play video on all clients;
						
							
					})
					this.socket.on('paused', data => {  
							this.events.push(data); 
					})
					this.socket.on('ready', data => {  
							this.events.push(data); //write to array, which will output to dom with v-for
					})
					this.socket.on('ended', data => {  
							this.events.push(data); //write to array, which will output to dom with v-for
					})
					this.socket.on('little_newbie', data => {  
						this.events.push(data); //write to array, which will output to dom with v-for
					})
					this.socket.on('play_all', data => {  
					
						this.player.playVideo();
							this.events.push(data);
					})
				
				}
		
				//setInterval(this.getNow, 5000);//refs are available only after mounted

		},
  	computed: {
    	player() {
				return this.$refs.youtube.player
			}
    },
		methods: {
			ready (event) {
					this.player = event.target;
					console.log('Player is ready.')
					this.socket.emit("ready");
			},
			ended (){
				console.log('Yay. You`ve stayed until the end . Video ended!')
				this.socket.emit("ended");
			},
			playing () {
				console.log('\o/ we are watching!!!')
				this.socket.emit("playing");//1. Emit from client to server, from server back, and client show again		
			},
			paused () {
				console.log('Video paused')
				this.socket.emit("paused");
			},
			playVideo() {
				this.player.playVideo()
			},
			pauseVideo(){
				this.player.pauseVideo()
			},
			seekTo(){
				this.player.seekTo(5 , false)
			},
			playAll(){
				this.socket.emit("play_all")
			}

		}, //methods

	}
	</script>

	<!-- Add "scoped" attribute to limit CSS to this component only -->
<style>
		#youtubeTerminal{
			position: absolute;
			bottom:0px;
			right:10px;
		}
		#ytb{
			position: absolute;
			top:0;
			right:10px;
		}

		ul.list-container  {
			list-style-type: none;
			font-size: 14px;
			height: 150px;
			width:400px;
			margin:0;
			overflow-y: auto;
			background-color: #33485E;
			color:#ffffff;
			padding: 12px;
			border-radius: 0px 0px 8px 8px;
		}
		.timestamp{
			opacity: 0.75;
			font-size:12px;
			color: #ffffff;
			font-weight: 400;
			padding-left:3px;
		float: right;
		}

		/*MacOs Terminal*/ 

	#bar {
			text-align: center;
			width: 424px;
			height: 25px;
			background-color: #DAD9D9;
			margin: 0 ;
			font-family: monospace;
			padding: auto;
			float: none;
			border-radius: 5px;
			position: relative;
	}
	#red {
			background-color: #E94B35;
			border-radius: 100%;
			width: 15px;
			height: 15px;
			margin: 0 auto;
			left: -200px;
			bottom: -20%;
			position:relative;
	}
	#yellow {
			background-color: #f0f000;
			border-radius: 100%;
			width: 15px;
			height: 15px;
			margin: 0 auto;
			left: -180px;
			bottom: 40%;
			position:relative;
			display: block;
	}
	#green {
			background-color: #1AAF5C;
			border-radius: 100%;
			width: 15px;
			height: 15px;
			margin: 0 auto;
			left: -160px;
			bottom: 99%;
			position:relative;
			display: block;
	}
		#whatfor{
			position: absolute;
			height: 15px;
			left: 170px;
			top: 5px;
		}
		.ytb-but button{
			background-color:indianred;
		}
		.ytb-but {
				position: absolute;
			left: 52.4%;
			bottom: 0px;
		}
		#clear{
			float: right;
		}

		.play{
			color: #00ff00;
		}
		.pause{
				color: #f1f227;
		}
		.id {
			color: #be90d4;
		}
		.leftRoom{
			text-decoration: line-through;

		}
		.endView{
			color: #ff6347
		}

	</style>
